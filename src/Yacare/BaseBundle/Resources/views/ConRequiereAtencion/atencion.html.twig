{% extends 'TapirAbmBundle::editar.html.twig' %}
{% set tapir_editar_nombreguadar = 'Aceptar' %}
{% block pagina_titulo %}Solicitar atención{% endblock %}

{% block pagina_contenido %}
<div class="row form-group">
    <div class="col-sm-10 col-sm-offset-2">
		{% if res.Entidad.RequiereAtencionObs %}
			{% if res.Entidad.RequiereAtencion %}
				<p>Alguien solicitó atención sobre este elemento, por el siguiente motivo:</p>
			{% else %}
				<p>Alguien marcó este elemento como revisado (que ya no requiere atención), con la siguiente
					observación:</p>
			{% endif %}
			<p class="form-control-static">{{ res.Entidad.RequiereAtencionObs }}</p>
		{% endif %}
	</div>
</div>
<div class="row form-group">	
	<div class="col-sm-10 col-sm-offset-2">
		{% if res.Entidad.RequiereAtencion %}
			<p>Puede marcar este elemento como revisado (que ya no requiere atención). Al hacerlo debe proporcionar
				una observación.</p>
		{% else %}
		    <p>Puede poner una marca de atención sobre este elemento para indicar que debe ser revisado. Al hacerlo
		    	debe especificar el motivo.</p>
		{% endif %}
		
		{{ form_widget(res.FormularioEditar.RequiereAtencionObs) }}
    </div>
</div>

{{ parent() }}
{% endblock pagina_contenido %}

{% block pagina_acciones %}
<button type="button"
	{% if tapir_modal is not defined or tapir_modal == 0 %}
		onclick="return tapirAtras();"
	{% else %}
	    data-dismiss="modal"
	{% endif %}
	class="btn btn-default">Cancelar</button>
<button type="submit" value="Guardar" class="btn {% if res.Entidad.RequiereAtencion %}btn-success{% else %}btn-danger{% endif %} tapir-button-accept">
    {% if res.Entidad.RequiereAtencion %}
	    <i class="fa fa-fw fa-thumbs-o-up"></i>
		{% if res.Entidad.RequiereAtencionObs %}
			Ya no
		{% else %}
			No
		{% endif %}
		requiere atención
    {% else %}
    	<i class="fa fa-fw fa-hand-paper-o"></i> Solicitar atención
    {% endif %}
</button>
{% endblock pagina_acciones %}

{% block pagina_scripts %}
<script>
	var form_RequiereAtencionObs_changed = false;
    $(function() {
    	$('#form_RequiereAtencionObs').change(function() {
    		form_RequiereAtencionObs_changed = true;
    	});

    	RequiereAtencion({% if not res.Entidad.RequiereAtencion %}0{% else %}1{% endif %});
    });

	function RequiereAtencion(valor) {
		if($('#form_RequiereAtencion').val() != valor) {
    		$('#form_RequiereAtencion').val(valor);
    		if(form_RequiereAtencionObs_changed == false) {
    			$('#form_RequiereAtencionObs').val('');
    		}
    		if(valor) {
    			$('#form_RequiereAtencion_Boton0').removeClass('active btn-success');	
    			$('#form_RequiereAtencion_Boton1').addClass('active btn-danger');
    			$('#form_RequiereAtencionObs').attr('placeholder', 'Por favor escriba el motivo por el cual solicita revisión');
    		} else {
    			$('#form_RequiereAtencion_Boton0').addClass('active btn-success');
    			$('#form_RequiereAtencion_Boton1').removeClass('active btn-danger');
    			$('#form_RequiereAtencionObs').attr('placeholder', 'Por favor escriba una observación sobre la solución o la revisión');
    		}
		}
	}
</script>
{% endblock pagina_scripts %}